-- ‚úÖ Obsidian UI Setup
local repo = "https://raw.githubusercontent.com/deividcomsono/Obsidian/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()

Library.ForceCheckbox = false
Library.ShowToggleFrameInKeybinds = true

local Window = Library:CreateWindow({
    Title = "Made by MasterZ",
    Footer = "v2.0.0",
    Icon = 0,
    NotifySide = "Right",
    ShowCustomCursor = true,
})

local Tabs = {
    Main = Window:AddTab("Main", "user")
}

local GroupBox = Tabs.Main:AddLeftGroupbox("Auto System")

-- ‚úÖ Auto NPC Toggle
GroupBox:AddToggle("AutoNPC", {
	Text = "Auto NPC",
	Default = false,
	Tooltip = "Terima visitor milik sendiri otomatis",
	Callback = function(v)
		if v then
			Library:Notify("‚úÖ Auto NPC aktif", 3)
		else
			Library:Notify("‚õî Auto NPC dimatikan", 3)
		end
	end,
})

-- ‚úÖ Rod Dropdown (Default hanya NormalRod)
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local Options = Library.Options
local Toggles = Library.Toggles
local RunService = game:GetService("RunService")

GroupBox:AddDropdown("SelectedRod", {
    Values = { "NormalRod" },
    Default = 1,
    Multi = false,
    Text = "Rod yang digunakan",
    Tooltip = "Pilih Rod yang sedang kamu pakai",
    Callback = function(v)
        Library:Notify("üé£ Rod aktif: " .. v, 3)
    end
})

-- ‚úÖ Tombol Refresh Rod dari Backpack
GroupBox:AddButton("üîÑ Refresh Rod dari Backpack", function()
    local backpack = player:FindFirstChild("Backpack")
    if not backpack then
        Library:Notify("‚ùå Backpack tidak ditemukan", 3)
        return
    end

    local rods = {}
    for _, item in ipairs(backpack:GetChildren()) do
        if item:IsA("Tool") and item.Name:lower():find("rod") then
            table.insert(rods, item.Name)
        end
    end

    if #rods == 0 then
        rods = { "Tidak ada Rod" }
    end

    Options.SelectedRod:SetValues(rods)
    Library:Notify("‚úÖ Rod di-refresh", 3)
end)

-- ‚úÖ Auto Fish Toggle
RunService.Heartbeat:Connect(function()
	if Toggles.AutoFish and Toggles.AutoFish.Value then
		local character = player.Character or player.CharacterAdded:Wait()
		local selectedRod = Options.SelectedRod.Value
		local rod = character:FindFirstChild(selectedRod)
		if rod and rod:FindFirstChild("MiniGame") then
			rod.MiniGame:FireServer("Complete")
		end
	end
end)

GroupBox:AddToggle("AutoFish", {
	Text = "Auto Fish",
	Default = false,
	Tooltip = "Otomatis mancing jika pegang Rod",
	Callback = function(v)
		if v then
			Library:Notify("üé£ Auto Fish aktif", 3)
		else
			Library:Notify("üõë Auto Fish dimatikan", 3)
		end
	end,
})
